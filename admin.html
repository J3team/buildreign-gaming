<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - BuildReign Gaming</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="support.css">
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar admin-navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <a href="index.html" style="text-decoration: none;">
                        <h1>BuildReign<span class="gaming">Gaming</span> <span class="admin-badge">ADMIN</span></h1>
                    </a>
                </div>
                <ul class="nav-menu">
                    <li><a href="admin.html" class="active">Dashboard</a></li>
                    <li><a href="index.html">View Site</a></li>
                </ul>
                <div class="user-menu">
                    <span id="adminGreeting" class="user-greeting"></span>
                    <button class="btn btn-small btn-danger" id="adminLogoutBtn" style="display: none;">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Admin Login Screen -->
    <div id="adminLoginScreen" class="admin-login-screen">
        <div class="admin-login-container">
            <div class="admin-login-card">
                <div class="admin-lock-icon">üîê</div>
                <h1>Admin Access</h1>
                <p>Enter your admin credentials to access the support ticket management system</p>
                <form id="adminLoginForm">
                    <div class="form-group">
                        <label for="adminEmail">Admin Email</label>
                        <input type="email" id="adminEmail" required placeholder="admin@buildreigngaming.com">
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">Password</label>
                        <input type="password" id="adminPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-large">Login to Admin Panel</button>
                </form>
                <div class="admin-whitelist-info">
                    <h4>Authorized Admins:</h4>
                    <ul id="whitelistDisplay"></ul>
                    <p class="demo-note">Demo: Use any whitelisted email with any password</p>
                </div>
                <a href="index.html" class="back-link">‚Üê Back to Website</a>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="admin-dashboard" style="display: none;">
        <div class="container">
            <!-- Stats Overview -->
            <div class="admin-stats-grid">
                <div class="admin-stat-card total">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-info">
                        <h3 id="adminTotalTickets">0</h3>
                        <p>Total Tickets</p>
                    </div>
                </div>
                <div class="admin-stat-card open">
                    <div class="stat-icon">üü¢</div>
                    <div class="stat-info">
                        <h3 id="adminOpenTickets">0</h3>
                        <p>Open Tickets</p>
                    </div>
                </div>
                <div class="admin-stat-card progress">
                    <div class="stat-icon">‚öôÔ∏è</div>
                    <div class="stat-info">
                        <h3 id="adminProgressTickets">0</h3>
                        <p>In Progress</p>
                    </div>
                </div>
                <div class="admin-stat-card pending">
                    <div class="stat-icon">‚è≥</div>
                    <div class="stat-info">
                        <h3 id="adminPendingTickets">0</h3>
                        <p>Awaiting Reply</p>
                    </div>
                </div>
                <div class="admin-stat-card closed">
                    <div class="stat-icon">‚úì</div>
                    <div class="stat-info">
                        <h3 id="adminClosedTickets">0</h3>
                        <p>Closed Tickets</p>
                    </div>
                </div>
                <div class="admin-stat-card critical">
                    <div class="stat-icon">üö®</div>
                    <div class="stat-info">
                        <h3 id="adminCriticalTickets">0</h3>
                        <p>Critical Priority</p>
                    </div>
                </div>
            </div>

            <!-- Filters and Actions -->
            <div class="admin-toolbar">
                <div class="filter-section">
                    <div class="filter-group">
                        <label>Status:</label>
                        <select id="adminStatusFilter" class="filter-select">
                            <option value="all">All Tickets</option>
                            <option value="open">Open</option>
                            <option value="in-progress">In Progress</option>
                            <option value="awaiting-reply">Awaiting Reply</option>
                            <option value="closed">Closed</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Priority:</label>
                        <select id="adminPriorityFilter" class="filter-select">
                            <option value="all">All Priorities</option>
                            <option value="critical">Critical</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Department:</label>
                        <select id="adminDepartmentFilter" class="filter-select">
                            <option value="all">All Departments</option>
                            <option value="sales">Sales</option>
                            <option value="technical">Technical Support</option>
                            <option value="shipping">Shipping & Delivery</option>
                            <option value="returns">Returns & Refunds</option>
                            <option value="warranty">Warranty Claims</option>
                            <option value="billing">Billing & Payments</option>
                            <option value="general">General Inquiry</option>
                        </select>
                    </div>
                </div>
                <div class="search-section">
                    <input type="text" id="adminSearch" placeholder="Search tickets..." class="search-input">
                    <button class="btn btn-secondary" onclick="refreshAdminTickets()">üîÑ Refresh</button>
                </div>
            </div>

            <!-- Tickets Table -->
            <div class="admin-card">
                <div class="card-header">
                    <h2>Support Tickets Management</h2>
                    <p>View and manage all customer support tickets</p>
                </div>
                <div class="admin-tickets-table">
                    <table id="adminTicketsTable">
                        <thead>
                            <tr>
                                <th>Ticket ID</th>
                                <th>Customer</th>
                                <th>Subject</th>
                                <th>Department</th>
                                <th>Priority</th>
                                <th>Status</th>
                                <th>Created</th>
                                <th>Last Update</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminTicketsBody">
                            <!-- Tickets will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Ticket Modal -->
    <div id="adminTicketModal" class="modal">
        <div class="modal-content modal-large admin-modal">
            <span class="modal-close">&times;</span>
            <div class="ticket-details">
                <div class="admin-ticket-header">
                    <div>
                        <h2>Ticket #<span id="adminModalTicketNumber"></span></h2>
                        <p class="ticket-subject" id="adminModalSubject"></p>
                    </div>
                    <div class="admin-actions-header">
                        <select id="adminModalStatus" class="status-select">
                            <option value="open">Open</option>
                            <option value="in-progress">In Progress</option>
                            <option value="awaiting-reply">Awaiting Reply</option>
                            <option value="closed">Closed</option>
                        </select>
                        <button class="btn btn-small btn-primary" onclick="updateTicketStatus()">Update Status</button>
                    </div>
                </div>

                <div class="admin-ticket-info">
                    <div class="info-section">
                        <h3>Customer Information</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <strong>Name:</strong>
                                <span id="adminModalCustomerName"></span>
                            </div>
                            <div class="info-item">
                                <strong>Email:</strong>
                                <span id="adminModalCustomerEmail"></span>
                            </div>
                            <div class="info-item">
                                <strong>Order Number:</strong>
                                <span id="adminModalOrderNumber"></span>
                            </div>
                        </div>
                    </div>
                    <div class="info-section">
                        <h3>Ticket Details</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <strong>Department:</strong>
                                <span id="adminModalDepartment"></span>
                            </div>
                            <div class="info-item">
                                <strong>Priority:</strong>
                                <span id="adminModalPriority"></span>
                            </div>
                            <div class="info-item">
                                <strong>Created:</strong>
                                <span id="adminModalCreated"></span>
                            </div>
                            <div class="info-item">
                                <strong>Last Update:</strong>
                                <span id="adminModalUpdated"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="ticket-messages" id="adminTicketMessages">
                    <!-- Messages will be loaded here -->
                </div>

                <div class="admin-ticket-reply">
                    <h3>Staff Reply</h3>
                    <form id="adminReplyForm">
                        <textarea id="adminReplyMessage" placeholder="Type your reply to the customer..." rows="5"></textarea>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Send Reply & Update Status</button>
                            <button type="button" class="btn btn-secondary" onclick="closeAdminTicketModal()">Close</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="delete-confirm">
                <div class="warning-icon">‚ö†Ô∏è</div>
                <h2>Delete Ticket?</h2>
                <p>Are you sure you want to delete ticket #<span id="deleteTicketId"></span>?</p>
                <p class="warning-text">This action cannot be undone.</p>
                <div class="form-actions">
                    <button class="btn btn-danger" onclick="confirmDelete()">Yes, Delete</button>
                    <button class="btn btn-secondary" onclick="closeModal('deleteModal')">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Firebase Configuration & Database -->
    <script src="firebase-config.js"></script>
    <script src="firebase-db.js"></script>

    <!-- Support & Admin System -->
    <script src="support.js"></script>
    <script src="admin.js"></script>
</body>
</html>
